import{g as l}from"./utils.DTxwb8SN.js";class r{constructor(){document.addEventListener("astro:page-load",()=>this.init()),document.readyState==="complete"&&this.init()}init(){this.initializeSalesMessage(),this.initializeBuyNowButtons(),this.initializeGallery(),this.initializeVideoPlayer(),this.initializePreviewModal()}initializeSalesMessage(){const e=document.getElementById("vendidos"),t=document.querySelector("[data-productid]")?.getAttribute("data-productid");if(!e||!t)return;const o=`sales_${t}`,i=document.cookie.split(";").find(a=>a.trim().startsWith(`${o}=`))?.split("=")[1];let n=i?parseInt(i):l();if(!i){const a=new Date;a.setDate(a.getDate()+7),document.cookie=`${o}=${n};expires=${a.toUTCString()};path=/`}n>0?e.innerHTML=`<b>${n} Nvitaciones vendidas</b> en el Ãºltimo mes.`:e.innerHTML=""}initializeGallery(){const e=document.querySelector(".main-image"),t=document.querySelector(".main-image-container"),o=document.querySelectorAll(".thumbnail-wrapper");if(!e||!o.length||!t)return;const i=e.src;o[0].classList.add("active"),o.forEach((n,a)=>{n.addEventListener("click",()=>{const s=a===0?i:n.getAttribute("data-full-img");s&&(e.src=s,o.forEach(d=>d.classList.remove("active")),n.classList.add("active"))})})}initializeVideoPlayer(){const e=document.getElementById("video-producto"),t=document.getElementById("play"),o=document.getElementById("video-home");if(!e||!t||!o)return;const i=e.cloneNode(!0),n=t.cloneNode(!0);e.parentNode?.replaceChild(i,e),t.parentNode?.replaceChild(n,t);const a=s=>{if(s.preventDefault(),s.stopPropagation(),i.paused){const d=i.play();d!==void 0&&d.then(()=>{n.style.display="none"}).catch(c=>{console.error("Error reproduciendo video:",c),n.style.display="flex"})}else i.pause(),n.style.display="flex"};i.addEventListener("play",()=>n.style.display="none"),i.addEventListener("pause",()=>n.style.display="flex"),i.addEventListener("ended",()=>{i.currentTime=0,n.style.display="flex"}),n.addEventListener("click",a),i.addEventListener("click",a),n.style.display="flex"}initializeBuyNowButtons(){document.querySelectorAll('[data-action="buy-now"]').forEach(t=>t.addEventListener("click",this.handleBuyNow))}handleBuyNow(e){e.preventDefault();const o=e.currentTarget.getAttribute("data-productid");if(!o)return;const i=this.getCartItemsFromCookie();i.includes(o)||(i.push(o),document.cookie=`cartItems=${JSON.stringify(i)};path=/;max-age=31536000`,document.dispatchEvent(new CustomEvent("cart:updated"))),window.location.href="/nvitaciones/checkout"}getCartItemsFromCookie(){const e=document.cookie.split(";").find(t=>t.trim().startsWith("cartItems="))?.split("=")[1];return e?JSON.parse(e):[]}initializePreviewModal(){const e=document.getElementById("preview-btn"),t=document.getElementById("preview-modal"),o=t?.querySelector(".close-btn"),i=t?.querySelector(".modal-backdrop"),n=()=>{t?.classList.add("active"),document.body.style.overflow="hidden",t?.dispatchEvent(new CustomEvent("modal:open"))},a=()=>{t?.classList.remove("active"),document.body.style.overflow="",t?.dispatchEvent(new CustomEvent("modal:close"))};e?.addEventListener("click",s=>{s.preventDefault(),n()}),o?.addEventListener("click",a),i?.addEventListener("click",a)}}new r;
