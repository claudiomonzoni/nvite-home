import{s as r}from"./index.fCeZaw72.js";import"./_commonjsHelpers.D6-XlEtG.js";import"./index.DE3JXa-m.js";const f=async(n,u)=>{const m=window.location.origin;return await(await fetch(`${m}/api/getInvitado.json?id=${n}&uid=${u}`)).json()},b=document.querySelector("#editar-invitado-dialog"),c=document.querySelector("#editar-formu"),S=document.querySelector("#editar-invitado-dialog"),l=document.querySelector("#mensaje-vip-container"),y=document.querySelector("input[name='vip']");y?.addEventListener("change",()=>{l&&(l.style.display=y.checked?"block":"none")});c.addEventListener("submit",async n=>{if(n.preventDefault(),!c.querySelector("input[name='nombre']").value.trim()){alert("El nombre no puede estar vacío.");return}const s=parseInt(c.querySelector("input[name='pases']").value,10);if(isNaN(s)||s<0){alert("El número de pases debe ser un número positivo.");return}const a=b.dataset.refedit;try{const e=new FormData(c),p={usuarioId:a,nombre:r(e.get("nombre")),pases:r(e.get("pases")),mesa:r(e.get("mesa")),numeroWhats:r(e.get("numeroWhats")),confirmado:e.get("confirmado")==="on",vip:e.get("vip")==="on",mensajePersonalizado:e.get("vip")==="on"?r(e.get("mensajePersonalizado")):null,InvitacionEnviada:e.get("InvitacionEnviada")==="on",noAsiste:e.get("noAsiste")==="on",tipoInvitacion:r(e.get("tipoInvitacion"))},o=await fetch(`/api/${a}.json`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)});if(!o.ok){const d=await o.text();throw new Error(`Error en la solicitud: ${o.status} ${o.statusText}. Respuesta: ${d}`)}let i;try{i=await o.json()}catch{throw new Error("La respuesta del servidor no es JSON válido.")}if(i.success)c.reset(),S.close(),location.reload();else throw new Error(i.message||"Ocurrió un error desconocido.")}catch(e){console.error("Error en la solicitud:",e),alert(e.message)}});const g=document.querySelector("#editar-invitado-dialog"),q=document.getElementById("cerrar-dialog-editar");q.addEventListener("click",()=>g.close());const I=(n,u,m)=>{const s=n.querySelector("input[name='nombre']"),a=n.querySelector("input[name='pases']"),e=n.querySelector("input[name='mesa']"),p=n.querySelector("input[name='numeroWhats']"),o=n.querySelector("input[name='confirmado']"),i=n.querySelector("input[name='vip']"),d=n.querySelector("input[name='InvitacionEnviada']"),h=n.querySelector("input[name='noAsiste']"),v=n.querySelector("textarea[name='mensajePersonalizado']");f(u,m).then(t=>{t&&t[0]&&(n.dataset.refedit=t[0].id,s.value=t[0].nombre,a.value=t[0].pases,e.value=t[0].mesa?.toString()||"",p.value=t[0].numeroWhats?.toString()||"",o.checked=t[0].confirmado,i.checked=t[0].vip,d.checked=t[0].InvitacionEnviada,h.checked=t[0].noAsiste,v&&(v.value=t[0].mensajePersonalizado||"",l&&(l.style.display=t[0].vip?"block":"none")))})};window.llenar=I;
