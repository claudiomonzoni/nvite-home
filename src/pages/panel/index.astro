---
import { NvitaAuth } from "../../firebase/config";
import Layout from "../../layouts/panelInvitados.astro";

const usuario = NvitaAuth.currentUser?.uid;
const usuarioEmail = NvitaAuth.currentUser?.email;

const request = await fetch(`${Astro.url.origin}/api/getInvitados.json?email=${usuarioEmail}`);
const invitadosData = await request.json();
import Invitado from "../../components/PanelInvitados/Invitado.astro";
import type {InvitadoProps} from "../../components/PanelInvitados/Invitado.astro";
import Dialog from "../../components/PanelInvitados/Dialog.astro";


---

<Layout title="Panel de administración">
    <h2>
        {usuario && <p>Bienvenido {usuarioEmail}</p>}
    </h2>

    <ul>
        {invitadosData && invitadosData.length > 0 ? (
          invitadosData.map((invi: InvitadoProps) => (
            <li><Invitado invitadoData={invi} /></li>
          ))
        ) : (
          <h2>Error</h2>
        )}
      </ul>
    
{
    invitadosData && invitadosData.length > 0 ? (
        <button id="agregar-invitado">Agregar invitado</button>
        <Dialog />
    ): (
        <p>Contacte al administrador para tener acceso a esta sección</p>
    )
}


<li>Mostrar invitados, formulario de agregarlos con un icono +</li>
<li>Cada invitado con icono de editar y borrar</li>
<li>Cada invitado deberá poder confirmar desde la invitacion </li>

</Layout>